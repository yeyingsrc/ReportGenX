# =============================================================================
# æ¨¡æ¿å…ƒæ•°æ®å®šä¹‰æ–‡ä»¶ - æ¸—é€æµ‹è¯•æŠ¥å‘Š (Penetration_Test)
# =============================================================================
# æ­¤æ–‡ä»¶å®šä¹‰äº†æ¨¡æ¿çš„æ‰€æœ‰å­—æ®µã€åˆ†ç»„ã€æ•°æ®æºå¼•ç”¨å’Œè¡Œä¸ºè§„åˆ™
# =============================================================================

# --- åŸºæœ¬ä¿¡æ¯ ---
id: Penetration_Test
name: æ¸—é€æµ‹è¯•æŠ¥å‘Š
description: ç”¨äºç”Ÿæˆæ¸—é€æµ‹è¯•æŠ¥å‘Šï¼ŒåŒ…å«æµ‹è¯•èŒƒå›´ã€æ¼æ´è¯¦æƒ…ã€é£é™©è¯„ä¼°ç­‰å†…å®¹
version: "1.0.0"
order: 3
template_file: template.docx
icon: ""
author: ReportGenX Team
create_time: "2026-01-30"
update_time: "2026-01-30"

# --- å­—æ®µåˆ†ç»„å®šä¹‰ ---
field_groups:
  - id: basic
    name: åŸºç¡€ä¿¡æ¯
    icon: "ğŸ“‹"
    order: 1
    collapsed: false
    
  - id: test_info
    name: æµ‹è¯•ä¿¡æ¯
    icon: "ğŸ”"
    order: 2
    collapsed: false
    
  - id: system_intro
    name: ä¸šåŠ¡ç³»ç»Ÿç®€ä»‹
    icon: "ğŸ“"
    order: 3
    collapsed: true
    
  - id: summary
    name: æ‘˜è¦ä¸ç»“è®º
    icon: "ğŸ“Š"
    order: 4
    collapsed: false
    
  - id: vulns
    name: æ¼æ´ä¿¡æ¯
    icon: "ğŸ›"
    order: 5
    collapsed: false

# --- æ•°æ®æºå®šä¹‰ ---
data_sources:
  - id: vulnerabilities
    type: database
    description: æ¼æ´åº“æ•°æ®
    
  - id: unit_types
    type: config
    config_key: unitType
    description: å•ä½ç±»å‹é€‰é¡¹
    
  - id: industries
    type: config
    config_key: industry
    description: è¡Œä¸šç±»å‹é€‰é¡¹

# --- å­—æ®µå®šä¹‰ ---
fields:
  # ========== åŸºç¡€ä¿¡æ¯ç»„ ==========
  - key: unit_name
    label: å•ä½åç§°
    type: text
    group: basic
    order: 1
    required: true
    placeholder: è¯·è¾“å…¥è¢«æµ‹å•ä½åç§°
    template_placeholder: "#unit_name#"
    
  - key: system_full_name
    label: ç³»ç»Ÿåç§°
    type: text
    group: basic
    order: 2
    required: true
    placeholder: å¦‚ï¼šXXç³»ç»ŸXX
    help_text: ç”¨äºæŠ¥å‘Šå°é¢ã€æ ‡é¢˜å’Œé¡µçœ‰
    template_placeholder: "#system_full_name#"
    
  - key: supplier_name
    label: æŠ€æœ¯æ”¯æŒå•ä½
    type: text
    group: basic
    order: 3
    required: true
    source: config.supplierName
    editable_config: true
    save_to_config: true
    placeholder: è¯·è¾“å…¥æŠ€æœ¯æ”¯æŒå•ä½åç§°
    help_text: æä¾›æ¸—é€æµ‹è¯•æœåŠ¡çš„å•ä½
    template_placeholder: "#supplier_name#"

  - key: test_start_date
    label: æµ‹è¯•å¼€å§‹æ—¶é—´
    type: date
    group: basic
    order: 4
    required: true
    default: today
    template_placeholder: "#test_start_date#"
    
  - key: test_end_date
    label: æµ‹è¯•ç»“æŸæ—¶é—´
    type: date
    group: basic
    order: 5
    required: true
    default: today
    template_placeholder: "#test_end_date#"
    
  - key: report_date
    label: æŠ¥å‘Šæ—¥æœŸ
    type: date
    group: basic
    order: 6
    required: true
    default: today
    template_placeholder: "#report_date#"
    
  - key: tester_info_list
    label: æµ‹è¯•äººå‘˜ä¿¡æ¯
    type: tester_info_list
    group: test_info
    order: 1
    required: false
    help_text: ç‚¹å‡»æ·»åŠ æµ‹è¯•äººå‘˜ä¿¡æ¯ï¼Œå¯æ·»åŠ å¤šæ¡
    template_placeholder: "#tester_info_list#"
    columns:
      - key: tester_company
        label: æµ‹è¯•äººå‘˜å•ä½
        type: text
        placeholder: æµ‹è¯•äººå‘˜æ‰€å±å•ä½
        source: config.supplierName
        width: 50%
      - key: tester_ip
        label: æµ‹è¯•äººå‘˜IP
        type: text
        placeholder: æµ‹è¯•äººå‘˜ä½¿ç”¨çš„IPåœ°å€
        width: 50%

  # ========== æµ‹è¯•ä¿¡æ¯ç»„ ==========
  - key: test_targets
    label: æµ‹è¯•ç›®æ ‡åˆ—è¡¨
    type: target_list
    group: test_info
    order: 2
    required: true
    help_text: ç‚¹å‡»æ·»åŠ æµ‹è¯•ç›®æ ‡ï¼Œå¯æ·»åŠ å¤šä¸ª
    template_placeholder: "#test_targets#"
    columns:
      - key: system_name
        label: åº”ç”¨ç³»ç»Ÿåç§°
        type: text
        placeholder: å¦‚ï¼šXXä¸šåŠ¡ç³»ç»Ÿ
        template_placeholder: "#system_name#"
        width: 25%
      - key: system_url
        label: åº”ç”¨ç³»ç»ŸURL/IP
        type: text
        placeholder: http://example.com æˆ– 192.168.1.1
        template_placeholder: "#system_url#"
        width: 30%
      - key: system_port
        label: ç«¯å£
        type: text
        placeholder: "80"
        default: "80"
        template_placeholder: "#system_port#"
        width: 15%
      - key: test_account
        label: æµ‹è¯•è´¦å·
        type: text
        placeholder: æ— 
        default: æ— 
        template_placeholder: "#test_account#"
        width: 20%
    
  - key: system_intro_enabled
    label: å¯ç”¨ä¸šåŠ¡ç³»ç»Ÿç®€ä»‹ç« èŠ‚
    type: checkbox
    group: system_intro
    order: 1
    required: false
    default: false
    help_text: å¯ç”¨åå°†åœ¨æŠ¥å‘Šä¸­æ’å…¥ç‹¬ç«‹çš„"ä¸šåŠ¡ç³»ç»Ÿç®€ä»‹"ç« èŠ‚
    template_placeholder: "#system_intro_enabled#"
    
  - key: system_intro
    label: ä¸šåŠ¡ç³»ç»Ÿç®€ä»‹
    type: textarea
    group: system_intro
    order: 2
    required: false
    rows: 4
    placeholder: ç®€è¦æè¿°ç³»ç»ŸåŠŸèƒ½å’Œä¸šåŠ¡åœºæ™¯ï¼ˆå¯é€‰ï¼‰
    help_text: è‹¥ç³»ç»ŸåŠŸèƒ½ç®€å•ä¸”æ— é«˜å±æ¼æ´å¯ä¸å¡«
    template_placeholder: "#system_intro#"
    
  - key: system_intro_screenshots
    label: ç³»ç»Ÿæˆªå›¾
    type: image_list
    group: system_intro
    order: 3
    required: false
    max_count: 10
    accept: "image/*"
    paste_enabled: true
    with_description: true
    description_placeholder: "æè¿°æ­¤æˆªå›¾å±•ç¤ºçš„ç³»ç»Ÿç•Œé¢..."
    help_text: ä¸šåŠ¡ç³»ç»Ÿç•Œé¢æˆªå›¾ï¼Œæ”¯æŒå¤šå¼ 
    template_placeholder: "#system_intro_screenshots#"

  # ========== æ‘˜è¦ä¸ç»“è®ºç»„ ==========
  - key: overall_risk_level
    label: ç»¼åˆé£é™©è¯„çº§
    type: select
    group: summary
    order: 7
    required: true
    options:
      - value: æ— é£é™©
        label: æ— é£é™©
        color: "#198754"
      - value: ä½é£é™©
        label: ä½é£é™©
        color: "#28a745"
      - value: ä¸­é£é™©
        label: ä¸­é£é™©
        color: "#fd7e14"
      - value: é«˜é£é™©
        label: é«˜é£é™©
        color: "#dc3545"
    default: ä¸­é£é™©
    template_placeholder: "#overall_risk_level#"
    presets:
      æ— é£é™©:
        risk_assessment: "ä»æœ¬æ¬¡æ¸—é€æµ‹è¯•ç»“æœæ¥çœ‹ï¼Œ#system_full_name#ä¸šåŠ¡ç›¸å…³ç³»ç»Ÿåœ¨å®‰å…¨é˜²æŠ¤æ–¹é¢è¡¨ç°å‡ºè‰²ï¼ŒæˆåŠŸæŠµå¾¡æ‰€æœ‰æ”»å‡»æ¨¡æ‹Ÿï¼Œå±•ç°å‡ºæé«˜çš„å®‰å…¨æ€§å’Œæœ‰æ•ˆçš„é˜²æŠ¤æªæ–½"
        risk_suggestion: "å³ä¾¿ç³»ç»Ÿåœ¨å®‰å…¨é˜²æŠ¤æ–¹é¢è¡¨ç°å‡ºè‰²ï¼Œä»å»ºè®®ä»ä»¥ä¸‹å‡ ä¸ªæ–¹é¢è¿›è¡Œå®‰å…¨æ•´æ”¹åŠé˜²èŒƒï¼Œä»¥è¿›ä¸€æ­¥æé«˜ç½‘ç»œå®‰å…¨é˜²æŠ¤å’Œç®¡ç†æ°´å¹³ï¼š"
        remediation_measures:
          - security_audit
          - training
          - regular_review
      ä½é£é™©:
        risk_assessment: "ä»æœ¬æ¬¡æ¸—é€æµ‹è¯•ç»“æœæ¥çœ‹ï¼Œ#system_full_name#ä¸šåŠ¡ç›¸å…³ç³»ç»Ÿåœ¨å®‰å…¨æ€§ä¸Šè¡¨ç°è‰¯å¥½ï¼Œè™½ç„¶æ²¡æœ‰å‘ç°é‡å¤§æ¼æ´ï¼Œä½†ä»éœ€ç•™æ„æ½œåœ¨å¨èƒï¼Œä»¥ç¡®ä¿å®‰å…¨é˜²æŠ¤ç»§ç»­ä¿æŒåœ¨é«˜æ°´å¹³ã€‚"
        risk_suggestion: "è™½ç„¶ç³»ç»Ÿæ•´ä½“å®‰å…¨æ€§è‰¯å¥½ï¼Œä½†ä»éœ€æ³¨æ„æ½œåœ¨å¨èƒï¼Œå»ºè®®ä»ä»¥ä¸‹å‡ ä¸ªæ–¹é¢è¿›è¡Œæ•´æ”¹åŠé˜²èŒƒï¼š"
        remediation_measures:
          - monitoring_logging
          - regular_review
          - training
      ä¸­é£é™©:
        risk_assessment: "ä»æœ¬æ¬¡æ¸—é€æµ‹è¯•ç»“æœæ¥çœ‹ï¼Œ#system_full_name#ä¸šåŠ¡ç›¸å…³ç³»ç»Ÿæœªå‘ç°ä¸¥é‡æ¼æ´ï¼Œä½†ç³»ç»Ÿä»å¯èƒ½é¢ä¸´æœ‰ç»„ç»‡çš„ã€é«˜çº§åˆ«çš„æ”»å‡»é£é™©ã€‚"
        risk_suggestion: "é‰´äºç³»ç»Ÿå¯èƒ½é¢ä¸´æœ‰ç»„ç»‡çš„ã€é«˜çº§åˆ«çš„æ”»å‡»é£é™©ï¼Œå»ºè®®ç«‹å³é‡‡å–ä»¥ä¸‹æ•´æ”¹æªæ–½ï¼š"
        remediation_measures:
          - access_control
          - security_audit
          - patch_management
      é«˜é£é™©:
        risk_assessment: "ä»æœ¬æ¬¡æ¸—é€æµ‹è¯•ç»“æœæ¥çœ‹ï¼Œ#system_full_name#ä¸šåŠ¡ç›¸å…³ç³»ç»Ÿåœ¨å®‰å…¨é˜²æŠ¤ä¸Šå­˜åœ¨æ˜æ˜¾ç¼ºé™·ï¼Œå¯ä»¥æŠµæŒ¡ä¸€å®šç¨‹åº¦çš„æ”»å‡»è¡Œä¸ºï¼Œä½†éš¾ä»¥æŠµå¾¡æœ‰ç»„ç»‡çš„ã€é«˜çº§åˆ«çš„å®‰å…¨æ”»å‡»ã€‚"
        risk_suggestion: "ç”±äºç³»ç»Ÿåœ¨å®‰å…¨é˜²æŠ¤ä¸Šå­˜åœ¨æ˜æ˜¾ç¼ºé™·ï¼Œå»ºè®®ç«‹å³é‡‡å–è¡¥æ•‘æªæ–½ï¼ŒåŒ…æ‹¬ï¼š"
        remediation_measures:
          - vuln_fix
          - access_control
          - security_audit
          - backup_test
    
  - key: vuln_count_total
    label: æ¼æ´æ€»æ•°
    type: text
    group: summary
    order: 1
    required: false
    default: "0"
    template_placeholder: "#vuln_count_total#"
    
  - key: vuln_count_critical
    label: è¶…å±æ¼æ´æ•°
    type: text
    group: summary
    order: 2
    required: false
    default: "0"
    template_placeholder: "#vuln_count_critical#"
    
  - key: vuln_count_high
    label: é«˜å±æ¼æ´æ•°
    type: text
    group: summary
    order: 3
    required: false
    default: "0"
    template_placeholder: "#vuln_count_high#"
    
  - key: vuln_count_medium
    label: ä¸­å±æ¼æ´æ•°
    type: text
    group: summary
    order: 4
    required: false
    default: "0"
    template_placeholder: "#vuln_count_medium#"
    
  - key: vuln_count_low
    label: ä½å±æ¼æ´æ•°
    type: text
    group: summary
    order: 5
    required: false
    default: "0"
    template_placeholder: "#vuln_count_low#"
    
  - key: vuln_count_info
    label: å…¶ä»–æ¼æ´æ•°
    type: text
    group: summary
    order: 6
    required: false
    default: "0"
    template_placeholder: "#vuln_count_info#"
    
  - key: vuln_list_summary
    label: æ¼æ´æ±‡æ€»æè¿°
    type: textarea
    group: summary
    order: 8
    required: false
    rows: 2
    placeholder: å¦‚ï¼šä»»æ„æ–‡ä»¶ä¸Šä¼ ã€æœªæˆæƒè®¿é—®ã€SQLæ³¨å…¥ç­‰æ¼æ´
    help_text: ç®€è¦åˆ—å‡ºå‘ç°çš„ä¸»è¦æ¼æ´ç±»å‹
    template_placeholder: "#vuln_list_summary#"
    
  - key: risk_assessment
    label: ç»“æœè¯„ä¼°
    type: textarea
    group: summary
    order: 9
    required: false
    rows: 3
    placeholder: æ ¹æ®é£é™©ç­‰çº§è‡ªåŠ¨å¡«å……æˆ–æ‰‹åŠ¨è¾“å…¥
    help_text: æ ¹æ®ç»¼åˆé£é™©è¯„çº§æè¿°ç³»ç»Ÿå®‰å…¨çŠ¶å†µ
    template_placeholder: "#risk_assessment#"
    
  - key: risk_suggestion
    label: å»ºè®®æè¿°
    type: textarea
    group: summary
    order: 10
    required: false
    rows: 2
    placeholder: æ ¹æ®é£é™©ç­‰çº§è‡ªåŠ¨å¡«å……æˆ–æ‰‹åŠ¨è¾“å…¥
    help_text: é’ˆå¯¹é£é™©ç­‰çº§çš„æ•´æ”¹å»ºè®®å¼•å¯¼è¯­
    template_placeholder: "#risk_suggestion#"
    
  - key: remediation_measures
    label: æ•´æ”¹å»ºè®®
    type: checkbox_group
    group: summary
    order: 11
    required: false
    help_text: é€‰æ‹©é€‚ç”¨çš„æ•´æ”¹å»ºè®®ï¼Œå¯å¤šé€‰
    template_placeholder: "#remediation_measures#"
    options:
      - id: update_password
        label: å®šæœŸæ›´æ–°å¯†ç 
        description: "å®šæœŸæ›´æ–°å¯†ç ï¼šå»ºè®®æ¯ä¸‰ä¸ªåˆ°å…­ä¸ªæœˆæ›´æ¢ä¸€æ¬¡å¯†ç ã€‚è¿™æ ·å¯ä»¥ç¡®ä¿å³ä½¿å¯†ç è¢«æ³„éœ²ï¼Œæ”»å‡»è€…ä¹Ÿæ— æ³•é•¿æ—¶é—´è®¿é—®æ‚¨çš„è´¦æˆ·ã€‚"
      - id: update_system
        label: æ›´æ–°ç½‘ç«™ç³»ç»Ÿ
        description: "æ›´æ–°ç½‘ç«™ç³»ç»Ÿï¼šè€æ—§çš„ç½‘ç«™ç³»ç»Ÿå®¹æ˜“å—åˆ°å®‰å…¨æ¼æ´çš„æ”»å‡»ï¼Œå»ºè®®åŠæ—¶æ›´æ–°å’Œå‡çº§ç½‘ç«™ç³»ç»Ÿåˆ°æœ€æ–°ç‰ˆæœ¬ã€‚ç¡®ä¿ä½¿ç”¨çš„ç½‘ç«™å¹³å°ã€å†…å®¹ç®¡ç†ç³»ç»Ÿï¼ˆCMSï¼‰æˆ–å…¶ä»–ç›¸å…³è½¯ä»¶éƒ½æ˜¯æœ€æ–°çš„ï¼Œä»¥ä¿®å¤å·²çŸ¥æ¼æ´å¹¶æé«˜ç³»ç»Ÿçš„å®‰å…¨æ€§ã€‚"
      - id: close_services
        label: å…³é—­ä¸å¿…è¦çš„æœåŠ¡
        description: "å…³é—­ä¸å¿…è¦çš„æœåŠ¡ï¼šæ ¹æ®æ‚¨çš„éœ€æ±‚å’Œç³»ç»Ÿé…ç½®ï¼Œåœæ­¢æˆ–ç¦ç”¨ä¸å¿…è¦çš„æœåŠ¡ã€‚è¿™å¯ä»¥é€šè¿‡æœåŠ¡ç®¡ç†å·¥å…·æˆ–æ“ä½œç³»ç»Ÿçš„æœåŠ¡é…ç½®æ¥å®Œæˆã€‚ç¡®ä¿åªä¿ç•™å¿…è¦çš„æœåŠ¡è¿è¡Œã€‚"
      - id: access_control
        label: å¼ºåŒ–è®¿é—®æ§åˆ¶
        description: "å¼ºåŒ–è®¿é—®æ§åˆ¶ï¼šé‡‡å–é€‚å½“çš„è®¿é—®æ§åˆ¶ç­–ç•¥ï¼Œé™åˆ¶å†…ç½‘èµ„æºçš„è®¿é—®æƒé™ã€‚ä½¿ç”¨å¼ºå¯†ç å’Œå¤šå› ç´ èº«ä»½éªŒè¯ï¼Œé™åˆ¶ç‰¹æƒè®¿é—®ï¼Œå¹¶æ ¹æ®å·¥ä½œèŒè´£åŸåˆ™æ¥åˆ†é…æƒé™ï¼Œä»¥å‡å°‘å†…éƒ¨å¨èƒå’Œæ•°æ®æ³„éœ²çš„é£é™©ã€‚"
      - id: patch_management
        label: åŠæ—¶çš„å®‰å…¨æ›´æ–°å’Œè¡¥ä¸ç®¡ç†
        description: "åŠæ—¶çš„å®‰å…¨æ›´æ–°å’Œè¡¥ä¸ç®¡ç†ï¼šå®šæœŸæ›´æ–°ç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºï¼ŒåŠæ—¶å®‰è£…å®‰å…¨è¡¥ä¸ï¼Œä»¥ä¿®å¤å·²çŸ¥çš„æ¼æ´å’Œå¼±ç‚¹ã€‚è¿™å¯ä»¥æœ‰æ•ˆå‡å°‘æ½œåœ¨çš„å®‰å…¨é£é™©ã€‚"
      - id: regular_review
        label: å®šæœŸå®¡æŸ¥å’Œæ›´æ–°
        description: "å®šæœŸå®¡æŸ¥å’Œæ›´æ–°ï¼šå®šæœŸå®¡æŸ¥ç³»ç»Ÿçš„ç«¯å£å’ŒæœåŠ¡é…ç½®ï¼Œå¹¶æ ¹æ®éœ€è¦è¿›è¡Œæ›´æ–°ã€‚éšç€ç³»ç»Ÿå’Œéœ€æ±‚çš„å˜åŒ–ï¼Œå¯èƒ½ä¼šæœ‰æ–°çš„ç«¯å£å’ŒæœåŠ¡éœ€è¦å…³é—­æˆ–é‡æ–°è¯„ä¼°ã€‚"
      - id: backup_test
        label: å®šæœŸå¤‡ä»½å’Œæ¢å¤æµ‹è¯•
        description: "å®šæœŸå¤‡ä»½å’Œæ¢å¤æµ‹è¯•ï¼šå®šæœŸå¤‡ä»½é‡è¦çš„å†…ç½‘æ•°æ®ï¼Œå¹¶è¿›è¡Œæ¢å¤æµ‹è¯•ï¼Œä»¥ç¡®ä¿æ•°æ®çš„å®Œæ•´æ€§å’Œå¯æ¢å¤æ€§ã€‚åœ¨å‘ç”Ÿå®‰å…¨äº‹ä»¶æˆ–æ•°æ®æŸåæ—¶ï¼Œå¤‡ä»½å¯ä»¥å¸®åŠ©æ‚¨å¿«é€Ÿæ¢å¤ä¸šåŠ¡ï¼Œå¹¶å‡å°‘æ•°æ®ä¸¢å¤±çš„é£é™©ã€‚"
      - id: monitoring_logging
        label: ç›‘æ§å’Œæ—¥å¿—è®°å½•
        description: "ç›‘æ§å’Œæ—¥å¿—è®°å½•ï¼šå¯ç”¨ç³»ç»Ÿçš„ç›‘æ§å’Œæ—¥å¿—è®°å½•åŠŸèƒ½ï¼Œä»¥ä¾¿åŠæ—¶æ£€æµ‹å’Œå“åº”ä»»ä½•å¼‚å¸¸æ´»åŠ¨ã€‚ç›‘æ§ç½‘ç»œæµé‡ã€ç«¯å£æ´»åŠ¨å’ŒæœåŠ¡æ—¥å¿—ï¼Œä»¥å‘ç°æ½œåœ¨çš„å®‰å…¨é—®é¢˜ã€‚"
      - id: security_audit
        label: å®‰å…¨å®¡è®¡å’Œç›‘æ§
        description: "å®‰å…¨å®¡è®¡å’Œç›‘æ§ï¼šå»ºç«‹å®Œå–„çš„å®‰å…¨å®¡è®¡å’Œç›‘æ§æœºåˆ¶ï¼Œå¯¹ç³»ç»Ÿçš„æ´»åŠ¨è¿›è¡Œå®æ—¶ç›‘æ§å’Œè®°å½•ï¼ŒåŠæ—¶å‘ç°å¼‚å¸¸è¡Œä¸ºå’Œæ½œåœ¨çš„å®‰å…¨å¨èƒã€‚"
      - id: training
        label: åŸ¹è®­å’Œæ„è¯†æå‡
        description: "åŸ¹è®­å’Œæ„è¯†æå‡ï¼šæ³¨é‡åŸ¹è®­å‘˜å·¥çš„å®‰å…¨æ„è¯†ï¼Œå®šæœŸç»„ç»‡å®‰å…¨åŸ¹è®­å’Œæ¼”ç»ƒï¼Œç¡®ä¿å‘˜å·¥äº†è§£å®‰å…¨æœ€ä½³å®è·µï¼Œå¹¶èƒ½å¤Ÿæ­£ç¡®åº”å¯¹å®‰å…¨äº‹ä»¶ã€‚"
      - id: network_isolation
        label: å†…ç½‘éš”ç¦»
        description: "å†…ç½‘éš”ç¦»ï¼šç”±äºå†…ç½‘ç¼ºä¹éš”ç¦»ï¼Œå»ºè®®é‡‡å–é€‚å½“çš„ç½‘ç»œéš”ç¦»æªæ–½ï¼Œå¦‚ä½¿ç”¨é˜²ç«å¢™æˆ–è™šæ‹Ÿä¸“ç”¨ç½‘ç»œï¼ˆVPNï¼‰æ¥é™åˆ¶åŠå…¬ç½‘è®¿é—®å†…ç½‘çš„èŒƒå›´ã€‚è¿™æ ·å¯ä»¥å‡å°‘å†…ç½‘æš´éœ²ç»™å¤–éƒ¨ç½‘ç»œçš„é£é™©ï¼Œæé«˜ç½‘ç»œå®‰å…¨æ€§ã€‚"
      - id: security_review
        label: å®šæœŸå®‰å…¨å®¡æŸ¥
        description: "å®šæœŸå®‰å…¨å®¡æŸ¥ï¼šå®šæœŸè¿›è¡Œå®‰å…¨å®¡æŸ¥å’Œæ¼æ´æ‰«æï¼Œä»¥å‘ç°å’Œä¿®å¤æ½œåœ¨çš„å®‰å…¨é—®é¢˜ã€‚å¯ä»¥ä½¿ç”¨å®‰å…¨è¯„ä¼°å·¥å…·æˆ–è˜è¯·ä¸“ä¸šçš„å®‰å…¨å›¢é˜Ÿæ¥è¯„ä¼°æ‚¨çš„ç½‘ç»œå’Œç³»ç»Ÿï¼Œä»¥ç¡®ä¿åŠæ—¶å‘ç°å’Œè§£å†³å®‰å…¨æ¼æ´ã€‚"
      - id: employee_training
        label: åŠ å¼ºå‘˜å·¥å®‰å…¨æ„è¯†åŸ¹è®­
        description: "åŠ å¼ºå‘˜å·¥å®‰å…¨æ„è¯†åŸ¹è®­ï¼šæä¾›å®šæœŸçš„å®‰å…¨æ„è¯†åŸ¹è®­ï¼Œæ•™è‚²å‘˜å·¥æœ‰å…³ç½‘ç»œå®‰å…¨çš„æœ€ä½³å®è·µã€ç¤¾ä¼šå·¥ç¨‹å­¦æ”»å‡»çš„è¯†åˆ«å’Œé˜²èŒƒç­‰ã€‚å‘˜å·¥æ˜¯ç½‘ç»œå®‰å…¨çš„ç¬¬ä¸€é“é˜²çº¿ï¼Œä»–ä»¬çš„å®‰å…¨æ„è¯†å’Œè¡Œä¸ºå¯¹æ•´ä½“å®‰å…¨é˜²æŠ¤è‡³å…³é‡è¦ã€‚"
      - id: vuln_fix
        label: æ¼æ´ä¿®å¤
        description: "æ¼æ´ä¿®å¤ï¼šé’ˆå¯¹å­˜åœ¨çš„èº«ä»½ç»•è¿‡æ¼æ´å’Œæˆæƒä»»æ„æ–‡ä»¶å†™å…¥æ¼æ´ï¼Œå»ºè®®ç«‹å³å‡çº§æˆ–ä¿®è¡¥ç›¸å…³è½¯ä»¶æˆ–ç³»ç»Ÿç»„ä»¶ï¼Œç¡®ä¿æ¼æ´å¾—åˆ°ä¿®å¤ã€‚"
      - id: password_policy
        label: å¼ºåŒ–å¯†ç ç­–ç•¥
        description: "å¼ºåŒ–å¯†ç ç­–ç•¥ï¼šé’ˆå¯¹æœåŠ¡å™¨å­˜åœ¨å¼±å£ä»¤å’Œå¯†ç å¤ç”¨çš„é—®é¢˜ï¼Œå»ºè®®å¼ºåˆ¶è¦æ±‚ä½¿ç”¨å¼ºå¯†ç ç­–ç•¥ï¼ŒåŒ…æ‹¬å¯†ç é•¿åº¦ã€å¤æ‚æ€§è¦æ±‚ç­‰ã€‚ç¦æ­¢ä½¿ç”¨é»˜è®¤è´¦æˆ·å’Œå¯†ç ï¼Œç¡®ä¿æ¯ä¸ªè´¦æˆ·éƒ½æœ‰ç‹¬ç«‹ã€å¼ºå¯†ç ã€‚å®æ–½è´¦æˆ·é”å®šæœºåˆ¶ï¼Œå®šæœŸæ›´æ–°å¯†ç ã€‚"
      - id: db_security
        label: æ•°æ®åº“å®‰å…¨
        description: "æ•°æ®åº“å®‰å…¨ï¼šé’ˆå¯¹MySQLå­˜åœ¨å¯†ç å¤ç”¨çš„é—®é¢˜ï¼Œå»ºè®®ç¡®ä¿æ•°æ®åº“å¯†ç æ˜¯ç‹¬ç«‹ä¸”å¼ºå¯†ç ã€‚é¿å…åœ¨ä¸åŒç³»ç»Ÿæˆ–æœåŠ¡ä¸­å¤ç”¨ç›¸åŒçš„æ•°æ®åº“å¯†ç ã€‚å®šæœŸå®¡æŸ¥æ•°æ®åº“æƒé™å’Œè®¿é—®æ§åˆ¶ï¼Œç¡®ä¿åªæœ‰æˆæƒçš„ç”¨æˆ·å¯ä»¥è®¿é—®æ•°æ®åº“ã€‚"
      - id: key_management
        label: è®¿é—®å¯†é’¥ç®¡ç†
        description: "è®¿é—®å¯†é’¥ç®¡ç†ï¼šé’ˆå¯¹é˜¿é‡Œäº‘Accesskeyæ³„éœ²çš„é—®é¢˜ï¼Œå»ºè®®åŠæ—¶æ’¤é”€æ³„éœ²çš„Access Keyï¼Œå¹¶ç”Ÿæˆæ–°çš„å¯†é’¥ã€‚å®æ–½è®¿é—®å¯†é’¥çš„åˆç†ç®¡ç†å’Œä¿æŠ¤æªæ–½ï¼Œä¾‹å¦‚ä½¿ç”¨è®¿é—®å¯†é’¥ç®¡ç†æœåŠ¡ã€é™åˆ¶è®¿é—®å¯†é’¥çš„ä½¿ç”¨èŒƒå›´ç­‰ã€‚"
      - id: credential_protection
        label: å‡­æ®ä¿æŠ¤
        description: "å‡­æ®ä¿æŠ¤ï¼šé’ˆå¯¹å¼€å‘å…¬å¸Harborå‡­æ®æ³„éœ²çš„é—®é¢˜ï¼Œå»ºè®®åŠæ—¶é€šçŸ¥å¼€å‘å…¬å¸å¹¶åè°ƒè§£å†³å‡­æ®æ³„éœ²é—®é¢˜ã€‚å®¡æŸ¥å’Œæ›´æ–°æ‰€æœ‰ä¸å‡­æ®ç›¸å…³çš„è®¿é—®æƒé™å’Œå¯†é’¥ã€‚"
      - id: security_protection
        label: åœ¨å®‰å…¨é˜²æŠ¤æ–¹é¢
        description: "åœ¨å®‰å…¨é˜²æŠ¤æ–¹é¢ï¼šå»ºè®®å®Œå–„å®‰å…¨åŸºçº¿å¹¶å…¨é¢è¿›è¡Œå®‰å…¨åŠ å›ºï¼›åŠ å¼ºåŠå…¬ç»ˆç«¯ç®¡æ§ï¼Œå®Œå–„åŠå…¬ç½‘ç»œæ•°æ®å®‰å…¨ä¿æŠ¤æªæ–½ã€‚"
      - id: threat_detection
        label: åœ¨å¨èƒå‘ç°æ–¹é¢
        description: "åœ¨å¨èƒå‘ç°æ–¹é¢ï¼šå»ºè®®è¿›ä¸€æ­¥åŠ å¼ºAPTæ”»å‡»æ£€æµ‹å’Œå¨èƒç›‘æµ‹èƒ½åŠ›ï¼ŒåŠ å¼ºæ—¥å¸¸å®‰å…¨æ£€æŸ¥åŠ›åº¦ï¼Œå®Œå–„ç­‰çº§ä¿æŠ¤å’Œé£é™©è¯„ä¼°æœºåˆ¶ï¼Œå¯¹å®‰å…¨åŠ å›ºå’Œé˜²æŠ¤æ•ˆæœå®šæœŸè¿›è¡Œæ£€æŸ¥å’Œè¯„ä¼°ï¼ŒåŠæ—¶è¯†åˆ«å’Œæ¶ˆé™¤é£é™©ã€‚"
      - id: security_management
        label: åœ¨å®‰å…¨ç®¡ç†æ–¹é¢
        description: "åœ¨å®‰å…¨ç®¡ç†æ–¹é¢ï¼šå»ºè®®ç»§ç»­åŠ å¼ºå…¨ä½“ç³»ä¿¡æ¯å®‰å…¨å·¥ä½œçš„æ•´ä½“ç®¡ç†å’Œç»„ç»‡åè°ƒï¼Œå¼ºåŒ–äººå‘˜å®‰å…¨æ„è¯†ï¼Œä¸¥æ ¼è½å®å„é¡¹è§„ç« åˆ¶åº¦ï¼Œç»§ç»­åŠ å¼ºå®‰å…¨å¼€å‘å’Œä¸Šçº¿å‰å®‰å…¨æµ‹è¯•å·¥ä½œï¼Œä¸æ–­æå‡è¿ç»´ç®¡ç†æ°´å¹³ã€‚"

  # ========== æ¼æ´ä¿¡æ¯ç»„ ==========
  - key: vuln_details
    label: æ¼æ´è¯¦æƒ…åˆ—è¡¨
    type: vuln_list
    group: vulns
    order: 1
    required: false
    help_text: ç‚¹å‡»æ·»åŠ æ¼æ´ï¼Œå¯ä»æ¼æ´åº“é€‰æ‹©æˆ–æ‰‹åŠ¨è¾“å…¥
    template_placeholder: "#vuln_details#"
    data_source: vulnerabilities
    columns:
      - key: vuln_system
        label: æ‰€å±ç³»ç»Ÿ
        type: text
        required: true
        placeholder: å¦‚ï¼šé—¨æˆ·ç½‘ç«™ã€OAç³»ç»Ÿ
        help_text: ç”¨äºæ¼æ´æ¸…å•å’Œè¯¦æƒ…æ ‡é¢˜ï¼Œå¦‚"é—¨æˆ·ç½‘ç«™å­˜åœ¨SQLæ³¨å…¥æ¼æ´"
        width: 15%
      - key: vuln_name
        label: æ¼æ´åç§°
        type: searchable_select
        source: vulnerabilities
        required: true
        width: 20%
        on_select: fill_vuln_fields
      - key: vuln_level
        label: æ¼æ´çº§åˆ«
        type: select
        source: config.risk_levels
        default: ä¸­å±
        width: 10%
      - key: vuln_url
        label: URL/IP
        type: text
        placeholder: æ¼æ´æ‰€åœ¨URLæˆ–IPåœ°å€
        width: 20%
      - key: vuln_location
        label: æ¼æ´ä½ç½®
        type: text
        placeholder: å¦‚ï¼šç™»å½•é¡µé¢ã€æ–‡ä»¶ä¸Šä¼ æ¥å£
        width: 15%
      - key: vuln_description
        label: æ¼æ´åŠé£é™©æè¿°
        type: textarea
        rows: 3
        placeholder: æ¼æ´çš„è¯¦ç»†æè¿°åŠå¯èƒ½é€ æˆçš„é£é™©
      - key: vuln_evidence
        label: æ¼æ´ä¸¾è¯
        type: image_list
        max_count: 5
        accept: "image/*"
        paste_enabled: true
        with_description: true
        description_placeholder: "æˆªå›¾è¯´æ˜..."
      - key: vuln_suggestion
        label: ä¿®å¤å»ºè®®
        type: textarea
        rows: 3
        placeholder: æ¼æ´ä¿®å¤æ–¹æ¡ˆå’Œå»ºè®®
      - key: vuln_reference
        label: å‚è€ƒé“¾æ¥
        type: text
        placeholder: ç›¸å…³å‚è€ƒèµ„æ–™é“¾æ¥ï¼ˆå¯é€‰ï¼‰

# --- è¡Œä¸ºå®šä¹‰ ---
behaviors:
  - id: generate_doc_title
    trigger:
      field: system_full_name
      event: change
    actions:
      - type: compute
        target: doc_title
        expression: "${system_full_name}ä¸šåŠ¡ç›¸å…³ç³»ç»Ÿæ¸—é€æµ‹è¯•æŠ¥å‘Š"
        
  - id: auto_distribution_scope
    trigger:
      field: unit_name
      event: change
    actions:
      - type: compute
        target: distribution_scope
        expression: "é™${supplier_name}ã€${unit_name}ç›¸å…³é¡¹ç›®ç»„"

# --- éªŒè¯è§„åˆ™ ---
validation:
  rules:
    - fields: [unit_name, system_full_name]
      rule: required
      message: å•ä½åç§°å’Œç³»ç»Ÿåç§°ä¸ºå¿…å¡«é¡¹

# --- è¾“å‡ºé…ç½® ---
output:
  filename_pattern: "{unit_name}-{system_full_name}ä¸šåŠ¡ç›¸å…³ç³»ç»Ÿ-æ¸—é€æµ‹è¯•æŠ¥å‘Š.docx"
  output_dir: "output/report/{unit_name}"
  log_to_file: true
  log_pattern: "{report_date}_penetration_output.txt"

# --- é¢„è§ˆé…ç½® ---
preview:
  enabled: true
  fields:
    - key: unit_name
      label: å•ä½
    - key: system_full_name
      label: ç³»ç»Ÿ
    - key: overall_risk_level
      label: é£é™©ç­‰çº§
    - key: report_date
      label: æŠ¥å‘Šæ—¥æœŸ
